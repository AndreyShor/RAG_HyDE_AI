8
ing the convergence of the loss function, we settle on a neural
network with [120,120,120] units and a Rectified Linear Unit
activation function (see Figure 4). We further find that the min-
imum of the validation loss is generally achieved after Î”ğ‘¡=
500 epochs. However, by allowing for early stopping, we note
that the lowest redshift bin completes training earlier, whereas
higher redshift bins do not meet the early stopping criteria.
We further optimize training by allowing the initial learning
rate to decrease from an initial value of 10âˆ’3, to a minimum
value of 10âˆ’6 if the validation loss does not improve for Î”ğ‘¡=
30 epochs. We choose the Adam optimization algorithm and
a batch size = 18. Even though this batch size seems small
compared to the total data size, we check that larger batches
are not able to achieve as small losses for even larger number
of epochs.
This process of hyperparameter tuning is therefore done
within cross-validation, where each neural network is validated
using a different subset of the original training set, while the
test set remains unseen. The building process of the emulator
is shown in Figure 4.
In this way, we end up with 10 neural networks per redshift
bin at our disposal. To obtain the final prediction, we average
the prediction extracted from each model using the arithmetic
mean.
Since each model was trained in parallel and on a
different training set in cross-validation, the combination of
these models will give a better average performance than each
model individually. We also use this method to estimate the
combined emulatorâ€™s error, as shown in Figure 5. This shows
that the error from the emulator is significantly smaller than
the error on the data shown in Figure 3 and the one used in
[82] without model ensembling and a separate test set.
V.
RESULTS
The results of the main analyses for thermal and dark matter
parameters are shown in Figure 6 and Figure 7.
We em-
ploy a uniform prior on ğ‘šWDMâˆ’1, specifically U âˆ¼[0, 1]
keVâˆ’1, after verifying that the emulatorâ€™s predictions are un-
reliable in extrapolated regions of the parameter space. Simi-
larly, we impose a uniform prior on ğ‘“WDM, U âˆ¼[0, 1]. Fig-
ure 6 shows the 1 and 2ğœrecovered posterior projected in the
(ğ‘šWDMâˆ’1 âˆ’ğ‘“WDM) plane. The shape of the contours matches
the expected degeneracy between the two parameters, where
the data allows for a very light thermal relic as long as its abun-
dance is small (ğ‘šWDMâˆ’1 â†’1), or a heavy thermal relic with
large abundance ( ğ‘“WDM â†’1), with CDM at (ğ‘šWDMâˆ’1, ğ‘“WDM)
= (0,0) in this parameterization.
The default analysis uses
gaussian priors on ğ‘‡0ğ‘§ğ‘–centered on fitted ğ‘‡0ğ‘§ğ‘–measurements
from observations at low-ğ‘§([110]) and high-ğ‘§([111]), follow-
ing [46]. The second analysis (orange) represents the model
that incorporates all the physical considerations in addition to
the default priors. These include a thermal-dependent reso-
lution correction, patchy reionization correction and ğ‘¢0 âˆ’ğ‘‡0
informed through the measurement of ğœCMB from Planck [112].
In the following sections we describe each correction and the
constraints found for their corresponding analysis, which are
shown in Table II.
0.0
0.2
0.4
0.6
0.8
1.0
mWDM
1 (keV
1)
0.0
0.2
0.4
0.6
0.8
1.0
fWDM
Default
Patchy + 
CMB + Rscdm (u0)
1  Irsic+24
2  Irsic+24
FIG. 6: The 2D posterior distribution in the ğ‘“WDM and ğ‘šâˆ’1
WDM plane
for our default analysis (gaussian priors on ğ‘‡0) and for patchy + ğœCMB
+ ğ‘…ğ‘ cdm (ğ‘¢0). Vertical black and gray dashed lines correspond to
the 1ğœand 2ğœconstraints from [46]. The grid of simulations is also
shown as the starred black points.
The degeneracy between ğ‘“WDM and ğ‘šWDMâˆ’1 from Fig-
ure 6 is well-fitted by a power law of the form ğ‘“WDM =
ğ´Ã— (1keV/ğ‘šWDM)ğ‘. For the 2ğœcontours of the default anal-
ysis, we find ğ´= 0.14 Â± 0.0007 for the normalization, and ğ‘
= -1.1 Â± 0.0033 for the index parameter. We further identify
a combination of ğ‘“WDM and ğ‘šWDMâˆ’1 that is perpendicular to
the above degeneracy axis, and is best-constrained by the data,
through the parameter ğ‘ŠWDM â‰ˆğ‘“WDM (1 keV/ğ‘šWDM)3.4. The
1ğœmodels in the 2D posterior of Figure 6 result in the upper
bound ğ‘ŠWDM < 0.27 at 1ğœ.
A.
Thermal priors
To effectively constrain the (ğ‘šWDMâˆ’1 âˆ’ğ‘“WDM) plane, we
need to marginalize over the two astrophysical effects that
impact the small scale power spectrum apart from dark matter
free-streaming.
The thermal histories within our hydrodynamical simula-
tions were constructed to bracket observational constraints on
the thermal state of the IGM and effective optical depth evolu-
tion. These models can provide a useful prior in the (ğ‘¢0 âˆ’ğ‘‡0)
plane, corresponding to the gray band in the 2D contours in
the top row of Figure 7, as was done in [46].
Alternatively, as proposed by [46], one can impose a prior
on the thermal state of the IGM represented by ğ‘‡0, based on
observational data and therefore independent of the specific
physical models used in our analysis. We apply these priors in
our default analysis shown in Figure 7.
