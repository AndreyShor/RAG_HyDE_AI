3.6. DI-QKD against quantum collective attacks
The proof of Sec. 3.3 in [207] applies only to the zero-error case; those in 3.4,3.5 (Refs. [216, 217, 30]) allow
for errors but restrict Eve to perform individual attacks; Ref. [206] proved non universally composable
security under the assumption that Eve’s attack is arbitrary but is not correlated with the classical post-
processing of the raw key. Another variant of E91, we rename as CHSHc protocol because still adopts
CHSH and the security proof is provided on Eve’s collective attacks constrained by quantum physics (not
only by no-signaling) as in [54, 57]
Collective attacks in quantum theory. Given N the number of instances, the state prepared by Eve is
the same at each instance |Ψ⟩= |ψ⟩⊗N ∈HABE and Alice and Bob receive ρAB = TrE(|Ψ⟩⟨Ψ|) =
P
c pcρc
AB without unknowing dim HAB for Alice and Bob similarly to Eqs.
(40)-(41) for individual
attacks. Crucially, because any pair of binary measurements can be decomposed as the direct sum of
pairs of measurements acting on two-dimensional spaces, then ρc
AB ∈B(C2 ⊗C2) without restrictions.
At each ρc
AB, the classical ancilla c known to Eve determines which measurements Alice and Bob choose
[54]. Do similar results exist for more complex scenarios for m measurements of d outcomes [234]? Along
this line, some progress for n = 2, m →∞in [235, 236] conjectured in [237].
3.7. CHSH-M protocol - independent measurement devices
In analogy to the CHAIN-M protocol, we call this protocol CHSH-M protocol as extends the CHSH
scenario to the Bell scenario (2, M, 2) such that
the raw key KA = KB ∈{0, 1}N is generated by M = N separate pair of commuting measurements
[61, 60]
[Ax, By] = 0,
[Ma|x, Ma′|x′] = [Nb|y, Nb′|y′] = 0,
x, y = 1, . . . , M.
(63)
The commutation relations can be satisfied by either using the devices in parallel where the N bits
of the raw key are generated by N separate and non-interacting devices or using in a sequential way in
which the raw key is generated by repeatedly performing measurements provided that the functioning of
the devices do not depend on any internal memory storing the quantum states and measurement results
obtained in each round so that p has only one entry
p(a1, . . . , aN, b1, . . . , bN|x1, . . . , xN, y1, . . . , yN) = tr
 
ρAB
N
Y
i=1
Mai|xiNbi|yi
!
,
(64)
where ρAB = trE(ρABE).
After Alice’s N systems have been measured, ρAE = P
a p(a|xraw) |a⟩⟨a| ⊗ρE|a
where ρE|a is the reduced state of Eve conditioned on Alice measuring outcome a. The bound on
Eve’s knowledge in Eq. (69) is generalized by SPD methods (sec. 2.2). It yields
r ≥log2 f(cQ) −H(a|b)
(M=2)
=
1 −log2

1 +
p
2 −p2

−h
1 −p
2

,
(65)
with f a concave and monotonically decreasing function and cQ the quantum value. The equality spe-
cializes to CHSH with ρp from 2b, but the same calculation can be applied to
CHAIN protocol (M = 3), leading to a better key rate.
3.7.1. CHAIN protocol - random postselection pre-processing
Let us consider the CHAIN protocol. A possible pre-processing T act only on the rounds (x, y) = (0, 1)
for the raw key such that from (KA, KB) = {(ki
A, ki
B)}i 7→{(kik
A , kik
B )}ik preserving all (ki
A, ki
B) = (0, 0)
with probability ω00 = 1, and discarding with probability ω10 = ω01 = p if (ki
A, ki
B) = (0, 1) ∨(1, 0) and
ω11 = p2 if (ki
A, ki
B) = (1, 1) [211]. The reason is that we replaced the no-click events with 1 as discussed
in Sec. 2.4.1 so that (ki
A, ki
B) = (0, 0) are genuinely nonlocal correlated. The discarded instances are
publicly announced after the measurement, so Eve does not know them a priori. If (¯x, ¯y) = (x, y) ̸=
(0, 1) all the data must be kept to close the detection loophole. After that follows the post-processing.
The key rate is calculated from the postselected events.
let us represent the postselected events by
Vp = {ab|ab = 00, 01, 10, 11}. Given a bit pair, the probability that it can be kept is defined as pVp =
P
ab∈Vp ωabp(a, b|x, y). Therefore the probability distribution of postselected events is represented by
27
