8 
 
Fig. 4 MSE training and validation loss curves over 1000 epochs. The original simulated CBFi (label) was scaled by 
106 to prevent slow training convergence, the training and validation losses converged to ~84.35 (in the scaled 
units). The total training time for 1000 epochs was 9.4 hours. 
2.5 Monte Carlo simulation for test dataset generation 
We conducted MC simulations using the voxel-based Monte Carlo eXtreme (MCX)47 toolkit in 
MATLAB (R2023b, The MathWorks) to generate the test dataset. We simulated a slab human 
head model with a volume of 200Ã—200Ã—100 mm3, segmented into four layers, each layer 
representing scalp, skull, cerebrospinal fluid (CSF), and brain tissues. 785 nm light was used in all 
MC simulations, the layer thicknesses and optical parameters at 785 nm are listed in Table 3. Each 
simulation was executed with 5Ã—108 photons and the detector was positioned at ğœŒğœŒ = 35 mm to 
record the photon transfer and photon pathlength, thereby enabling the calculation of the temporal 
light field ACF7,48: 
ğºğº1(ğœğœ) = 1
ğ‘ğ‘ğ‘ğ‘
à·exp á‰Œà·âˆ’1
3 ğ‘Œğ‘Œğ‘›ğ‘›,ğ‘–ğ‘–ğ‘˜ğ‘˜0
2âŒ©âˆ†ğ‘Ÿğ‘Ÿ2(ğœğœ)âŒªğ‘–ğ‘–
ğ‘ğ‘ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡
ğ‘–ğ‘–=1
á‰exp á‰Œâˆ’à·ğœ‡ğœ‡ğ‘ğ‘,ğ‘–ğ‘–ğ¿ğ¿ğ‘›ğ‘›,ğ‘–ğ‘–
ğ‘ğ‘ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡
ğ‘–ğ‘–=1
á‰
ğ‘ğ‘ğ‘ğ‘
ğ‘›ğ‘›=1
,
(9) 
where ğ‘ğ‘ğ‘ğ‘ is the number of detected photons at each detector, ğ‘ğ‘ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ is the number of tissue types 
(ğ‘ğ‘ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ = 4 in our case), ğ‘Œğ‘Œğ‘›ğ‘›,ğ‘–ğ‘– and ğ¿ğ¿ğ‘›ğ‘›,ğ‘–ğ‘– are the total momentum transfer and total pathlength of 
photon ğ‘›ğ‘› in Layer ğ‘–ğ‘–, and ğœ‡ğœ‡ğ‘ğ‘,ğ‘–ğ‘– is the absorption coefficient in Layer ğ‘–ğ‘–. âŒ©âˆ†ğ‘Ÿğ‘Ÿ2(ğœğœ)âŒªğ‘–ğ‘–= 6ğ·ğ·ğ‘ğ‘ğ‘ğ‘ğœğœ is the 
mean square displacement of the scattered particles in Layer ğ‘–ğ‘–, where ğ·ğ·ğµğµğµğµ is the effective Brownian 
diffusion coefficient in Layer ğ‘–ğ‘–. The correlation delay time ğœğœ was set between 1.28 Âµs and 39.68 
Âµs with 31 linearly spaced data points to agree with the SPAD output data format. ğ›½ğ›½ was set to 0.5, 
ğ‘”ğ‘”2(ğœğœ) curves were obtained by substituting the normalized electric field ACF into Eq. (5). The 
anisotropic factor ğ‘”ğ‘” was set to 0.89 for all MC simulations. 
 
 
 
 
