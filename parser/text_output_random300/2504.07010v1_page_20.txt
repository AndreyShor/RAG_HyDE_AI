3.3
Synthetic data
We generated a set of multivariate Bernoulli product distributions of di-
mension, with dimensions s ∈{10, 20, 40, 80} and ground truth and per-
turbed weights, w, ˆw ∈[0, 1]s. Ground truth weights, with profile wlog i ∝
log(1+i)
s
, wrand i ∝U∗i
s , U ∼Uniform[0, 1], and wcos i ∝cos2( π
ϵ+i), ϵ = 10−4,
i = 1, . . . , s, were perturbed using three different perturbations, ϵlog i ∝
log(ϵ + wi), ϵrand i = wi ∗V , V ∈N(0, 1), and ϵcos i = cos(wi ∗2π). The
unspecified proportionality constants guaranteed that all wi and ˆwi were non-
negative and lower than 1. Each ground truth profile was perturbed with all
three perturbations. For all (w, ˆw) pairs, we estimated the Bhattacharyya
distance, dBC = −log BC, the Kullback–Leibler divergence, dKL, and the
Total Variation distance, dTV defined in (2), between the associated ground
truth and perturbed distributions with the density-ratio estimator of Sec-
tions 2.3 and 3.2 and compared them with the theoretical Bhattacharyya
distance between two multivariate Bernoulli product distributions,
¯dBC = −log
s
Y
i=1
p
wi ˆwi +
p
(1 −wi)(1 −ˆwi)

(49)
In the first run, the highest and lowest BC distances were 1.112 and 0.016,
for w = wcos, with ϵ = ϵlog and s = 80, and w = wlog, with ϵ = ϵcos and
s = 10.
3.4
Simulated data
A realistic data set was generated by designing circuits of varying sizes and
depths and running them on the IBM fake backends and the Qiskit Aer sim-
ulator (Qiskit, 2025) to obtain the corresponding noisy and ideal outputs,
ˆYn and Yn.
36 circuits, called W-State, Portfolio Optimization with
VQE, Deutsch-Jozsa, Graph State, GHZ State, and Variational Quantum
Eigensolver were generated using the algorithms of Apak et al. (2024)
with 6 different sizes s ∈{5, 7, 9, 11, 13, 15}. 12 circuits, called Random and
Deep Random, were generated using the Qiskit random generator with pa-
rameters, (nqubits = s, depth = s) and (nqubits = s, depth = 3 ∗s),
s ∈{5, 7, 9, 11, 13, 15}. 6 additional circuits, all with size 4 but different
depths, were generated using the walker method of Martina et al. (2022)
with depth parameter s ∈{5, 7, 9, 11, 13, 15}. Figure 2 displays an exam-
ple of a walker circuit with depth 3. All circuits were run 5 times on 5
