11
cesses while maintaining self-consistency in tem-
perature evolution.
2.7. Metallicity
Metallicity plays a fundamental role in many as-
trophysical processes, particularly in radiative cool-
ing. Metals, synthesized through stellar nucleosyn-
thesis, are injected into the ISM and CGM through
SN explosions and stellar winds, and subsequently
redistributed by turbulent diffusion. Therefore, in-
corporating metallicity evolution is essential for ac-
curate simulation of galaxy evolution. For compu-
tational efficiency while maintaining physical ac-
curacy, we track the evolution of total metallicity
rather than individual elemental abundances, as this
approach sufficiently captures the key physics, es-
pecially for cooling and heating calculations. Al-
though implementing a more detailed metallicity
model that tracks individual elements (e.g., Eisen-
reich et al. 2017) is valuable, such implementation
is straightforward within the MACER3D frame-
work and will be considered in future work.
The evolution of gas metallicity ğ‘gas is modeled
as a passive scalar governed by sink terms from
star formation and source terms from stellar yields,
following the equation:
ğ‘gas Â¤ğœŒgas = ğ‘II Â¤ğœŒII+ğ‘Ia Â¤ğœŒIa+ğ‘SE Â¤ğœŒSEâˆ’ğ‘gas Â¤ğœŒSF, (27)
where Â¤ğœŒII, Â¤ğœŒIa, and Â¤ğœŒSE denote the mass loss rates
from SN II, SN Ia, and stellar evolution respec-
tively, while Â¤ğœŒSF represents the star formation rate.
The corresponding metal yields are given by ğ‘II,
ğ‘Ia, and ğ‘SE.
Although metal production from
stellar winds is not explicitly included here, these
contributions are incorporated into the stellar evo-
lution models. While our implementation includes
metal diffusion to account for additional mixing
processes, this mechanism is deactivated in this
initial study using the MACER3D framework.
For SN yields, we adopt values from Hopkins
et al. (2018), with ğ‘Ia = 1 for SN Ia and ğ‘II =
1.02(1.9134 + 0.0479 Ëœğ‘)/10.5 for SN II, where
Ëœğ‘= max(ğ‘âˆ—/ğ‘âŠ™, 1.65). These yields represent
averages over the initial mass function. Given our
simulationâ€™s initial redshift of ğ‘§âˆ¼2, corresponding
to a turn-off mass ğ‘€TO âˆ¼1.4 MâŠ™, metal production
through stellar evolution primarily originates from
low-mass stars (ğ‘€âˆ—< 8MâŠ™) via planetary nebulae
and stellar winds. To determine stellar evolution
yields, we employ the yield tables from Nomoto
et al. (2013), implementing bilinear interpolation
to construct a fitting function ğ‘SE dependent on
both ğ‘€TO and stellar metallicity (ğ‘âˆ—).
2.8. Simulation suit
As the very first work of the MACER3D frame-
work, we focus on the evolution of an isolated el-
liptical galaxy and explore the impact of the AGN
feedback and SN feedback on the galaxyâ€™s evolu-
tion, respectively. We set up three simulations to
investigate the effects of different feedback mech-
anisms on the galaxyâ€™s evolution. The fiducial
simulation includes both AGN feedback and SN
feedback. Another two simulations, noAGNfb and
noSNfb, turn off AGN feedback and SN feed-
back, respectively, while other feedback mecha-
nisms (e.g., stellar wind) remain active. We note
that although the AGN feedback is disabled in
noAGNfb simulation, a central SMBH is still in-
cluded, therefore the central BH still accretes gas,
grows and give rise to luminosity, but neither out-
flows nor heating are produced. In all simulations,
multiple passive scalar tracers are included to track
the evolution of the mass from different sources,
including AGN winds (hot and cold traced sepa-
rately), stellar winds, ejecta of SNe Ia and SNe II,
and the ISM/CGM gas.
3. RESULTS
3.1. Time evolution of AGN luminosity and star
formation rate
Fig. 2 presents the temporal evolution of the AGN
luminosity ğ¿BH (normalized by the Eddington lu-
minosity ğ¿Edd) and the specific star formation rate
(sSFR) in our fiducial simulation. Both quantities
demonstrate pronounced temporal variability span-
ning multiple orders of magnitude. The AGN lu-
