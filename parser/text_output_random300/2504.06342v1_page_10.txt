10
104
106
108
10
21
10
25
0
10
25
10
21
104
106
108
Temperature [K]
[erg cm3 s 1]
-
Figure 1. A representative subset of the cooling func-
tions adopted in MACER3D, illustrating their depen-
dence on gas number density (left) and AGN radiation
flux (right). In the left panel, colors represent different
number densities ğ‘›H: 10âˆ’8 cmâˆ’3 (blue), 10âˆ’5 cmâˆ’3 (or-
ange), 10âˆ’2 cmâˆ’3 (green), 10 cmâˆ’3 (red), and 104 cmâˆ’3
(purple).
Solid and dashed lines correspond to red-
shifts of ğ‘§= 0 and ğ‘§= 2, respectively, with zero AGN
flux and solar metallicity.
In the right panel, colors
represent varying AGN radiation flux: 0 erg sâˆ’1 cmâˆ’2
(blue), 10âˆ’5 erg sâˆ’1 cmâˆ’2 (orange), 10âˆ’2 erg sâˆ’1 cmâˆ’2
(green), 10 erg sâˆ’1 cmâˆ’2 (red), 104 erg sâˆ’1 cmâˆ’2 (pur-
ple), and 107 erg sâˆ’1 cmâˆ’2 (brown). Solid and dashed
lines correspond to metallicities of 0.1 ğ‘âŠ™and ğ‘âŠ™, with
a fixed number density of 1 cmâˆ’3 and redshift of ğ‘§= 0.
Figure 1 illustrates a representative subset of the
cooling functions, in particular, showcasing their
dependence on gas density and AGN radiation flux.
The second enhancement in MACER3D is the
implementation of the Townsend exact cooling
integration scheme (Townsend 2009), which of-
fers superior robustness and precision compared
to conventional explicit or implicit time integration
schemes. This approach reformulates the energy
equation into an operator-split form:
âˆ«ğ‘‡ğ‘›+1
ğ‘‡ğ‘›
dğ‘‡
Î›(ğ‘‡) = âˆ’(ğ›¾âˆ’1)ğœ‡ğœŒ
ğ‘˜Bğœ‡ğ‘’ğœ‡ğ‘–ğ‘šp
Î”ğ‘¡,
(26)
where ğ›¾denotes the adiabatic index, ğœ‡the mean
molecular weight, ğœ‡ğ‘–(ğœ‡ğ‘’) the mean molecular
weight per ion (electron), and ğ‘šp the proton mass,
with ğ‘‡ğ‘›and ğ‘‡ğ‘›+1 representing the temperatures at
steps ğ‘›and ğ‘›+ 1, respectively. The mean molec-
ular weight is updated at each time step based on
local metallicity, with the full ionization approxi-
mation since individual species are not traced in our
simulations given both the computational cost and
complexity, and the star formation is consequently
treated as a subgrid model as described in Â§2.4. For
piecewise power-law cooling functions Î›(ğ‘‡), this
operator-split equation permits analytical solutions
through integration from a reference temperature
ğ‘‡ref to the current temperature ğ‘‡ğ‘›, enabling exact
calculation of the new temperature ğ‘‡ğ‘›+1 for arbi-
trary time steps. This scheme facilitates more ac-
curate and efficient temperature evolution by elim-
inating constraints from the Courant condition due
to short cooling times, thereby mitigating overcool-
ing issues. We also note that no time step limit
constrained by the cooling time is imposed in our
work, which is allowed by the Townsend scheme,
however, the time step limit from the Courant con-
dition in our simulations is typically as short as hun-
dreds of years due to the finest resolution, which is
sufficiently small compared to the cooling time.
We further extend the Townsend cooling scheme
to incorporate heating processes, including pho-
toionization and Compton heating from AGN and
UVB radiation. This extension introduces equilib-
rium points in the cooling curves where heating
balances cooling (indicated by net cooling curves
crossing zero on the y-axis in Fig. 1), which require
special consideration in the integration scheme.1
The modified scheme ensures accurate and simul-
taneous treatment of both cooling and heating pro-
1 The dimensionless temporal evolution function in Eq. (24) of
Townsend (2009), which describes temperature evolution by
integrating the cooling function from an arbitrary reference
temperature, approaches infinity at the equilibrium points by
definition. However, this singularity is purely mathematical,
and is eliminated by choosing two different reference tem-
peratures and performing integrations on each side of the
equilibrium point along the heating and cooling branches,
respectively.
