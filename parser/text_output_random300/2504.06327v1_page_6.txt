Physics-informed KAN PointNet
global 
feature
Shared KAN (ğ‘›ğ‘ Ã— 64, ğ‘›ğ‘ Ã— 64)
Shared KAN (ğ‘›ğ‘ Ã— 64, ğ‘›ğ‘ Ã— 128, ğ‘›ğ‘ Ã— 1024)
shared
shared
Shared KAN (ğ‘›ğ‘ Ã— 512, ğ‘›ğ‘ Ã— 256, ğ‘›ğ‘ Ã— 128)
ğ‘›ğ‘ Ã— 1024
Input
shared
shared
Shared KAN (ğ‘›ğ‘ Ã— 128, ğ‘›PDE)
ğ‘Ã— 2
ğ‘Ã— ğ‘›ğ‘ Ã— 64
ğ‘Ã— ğ‘›ğ‘ Ã— 1024
ğ‘Ã— ğ‘›ğ‘ Ã— 128
ğ‘Ã— ğ‘›PDE
Output
ğ‘Ã— ğ‘›ğ‘ Ã— 1088
Max pool
ğ’™1
ğ’™2
.
.
.
.
ğ’™ğ‘
â‹¯
ğ‘‹1
ğ‘‹2
ğ‘‹ğ‘š
Spatial coordinates
 of ğ‘š geometries
ğ›¿
ğ›¿ğ‘¥
ğ›¿
ğ›¿ğ‘¦
ğ›¿
ğ›¿ğ‘¥
ğ›¿
ğ›¿ğ‘¥
ğ›¿
ğ›¿ğ‘¦
ğ›¿
ğ›¿ğ‘¦
Automatic
differentiation
Physics-informed
 loss function
ğ’™1
ğ’™2
.
.
.
.
ğ’™ğ‘
ğ’™1
ğ’™2
.
.
.
.
ğ’™ğ‘
Figure 1: Architecture of the physics-informed Kolmogorov-Arnold PointNet (PI-KAN-PointNet). Shared KANs with the
labels (îˆ®1, îˆ®2) and (îˆ®1, îˆ®2, îˆ®3) are explained in the text. ğ‘›PDE denotes the number of variables in partial differential
equations. ğ‘is the number of points in the point clouds. ğ‘›ğ‘ is the global scaling parameter used to control the network
size. PI-KAN-PointNet utilizes automatic differentiation to compute spatial derivatives (e.g., ğ›¿Ìƒğ‘¢
ğ›¿ğ‘¦, ğ›¿Ìƒğ‘
ğ›¿ğ‘¥,
ğ›¿
ğ›¿ğ‘¦
(
ğ›¿Ìƒğ‘£
ğ›¿ğ‘¦
)
, etc.), which
are then used to formulate the physics-informed loss function (see Eq.30).
provided from î‰„ğ‘–to î‰…ğ‘–, where î‰…ğ‘–= {ğ’šğ‘—âˆˆâ„ğ‘›PDE}ğ‘
ğ‘—=1. The variable ğ‘›PDE indicates the number of fields we aim to
find. In this study, we focus on predicting the two-dimensional velocity vector, pressure and temperature fields, making
ğ‘›PDE = 4. Therefore, ğ’šğ‘—is the vector of predicted fields at the spatial point ğ’™ğ‘—, comprising the components ğ‘¢ğ‘—, ğ‘£ğ‘—, ğ‘ğ‘—,
and ğ‘‡ğ‘—. Mathematically, this process is described as:
(ğ‘¢ğ‘—, ğ‘£ğ‘—, ğ‘ğ‘—, ğ‘‡ğ‘—
) = ğ‘“((ğ‘¥ğ‘—, ğ‘¦ğ‘—
) , ğ‘”(î‰„ğ‘–
)) ;
âˆ€(ğ‘¥ğ‘—, ğ‘¦ğ‘—
) âˆˆî‰„ğ‘–and âˆ€(ğ‘¢ğ‘—, ğ‘£ğ‘—, ğ‘ğ‘—, ğ‘‡ğ‘—
) âˆˆî‰…ğ‘–with 1 â‰¤ğ‘–â‰¤ğ‘šand 1 â‰¤ğ‘—â‰¤ğ‘,
(19)
where ğ‘“represents the mapping function in PI-KAN-PointNet.
KA-PointNet is designed to be invariant to any permutation of the input vector î‰„ğ‘–, meaning that if the points in
î‰„ğ‘–are permuted, the geometric structure remains the same, and hence the solution î‰…ğ‘–should also remain unchanged.
This permutation invariance is achieved using a symmetric function in conjunction with shared KANs. The function
ğ‘”serves as a symmetric encoder of the geometric features of the point cloud î‰„ğ‘–. Following the approach introduced in
Ref. [41], we define ğ‘”as the maximum function:
ğ‘”(î‰„ğ‘–
) = max (â„(ğ‘¥1, ğ‘¦1
) , â€¦ , â„(ğ‘¥ğ‘, ğ‘¦ğ‘
)) ;
âˆ€(ğ‘¥ğ‘—, ğ‘¦ğ‘—
) âˆˆî‰„ğ‘–with 1 â‰¤ğ‘–â‰¤ğ‘šand 1 â‰¤ğ‘—â‰¤ğ‘,
(20)
where â„represents two shared KAN layers in the first branch of PI-KAN-PointNet (see Fig. 4). In the context of PI-
KAN-PointNet, ğ‘”(î‰„ğ‘–
) is referred to as the global feature. The key concept behind PI-KAN-PointNet, as a geometric
deep learning model, is that the predicted fields at each spatial point depend not only on the spatial coordinates of that
point but also on the overall geometric structure of the domain, formed by all points, including the specific point. This
idea is evident in Eqs. (19)â€“(20).
The batch size, ğµ, represents the number of point clouds (i.e., î‰„ğ‘–and î‰…ğ‘–pairs) processed by KA-PointNet at each
epoch. As illustrated in Fig. 4, the input to KA-PointNet is a three-dimensional tensor of size ğµÃ— ğ‘Ã— 2. Following
this, two sequential shared KANs with sizes (64, 64) and (64, 128, 1024) are applied, as shown in Fig. 4. The global
feature, of size 1024, is generated by applying the maximum function. This global feature is then concatenated with an
intermediate feature tensor of size ğµÃ— ğ‘Ã— 64, resulting in a tensor of size ğµÃ— ğ‘Ã— 1088. Next, two additional shared
KANs are applied, with sizes (512, 256, 128) and (128, ğ‘›PDE), respectively, yielding a tensor of size ğµÃ— ğ‘Ã— ğ‘›PDE, as
depicted in Fig. 4. After each KAN layer (except the last layer in the network), batch normalization [116] is applied to
ensure stable training and avoid divergence of the training loss.
For each ğ‘‰ğ‘–(1 â‰¤ğ‘–â‰¤ğ‘š) and its associated pair î‰„ğ‘–and î‰…ğ‘–, the residuals of the continuity equation (ğ‘Ÿcontinuity
ğ‘–
),
momentum conservation equations in the ğ‘¥âˆ’direction (ğ‘Ÿmomentumğ‘¥
ğ‘–
) and in the ğ‘¦âˆ’directions (ğ‘Ÿ
momentumğ‘¦
ğ‘–
), energy con-
servation equation (ğ‘Ÿenergy
ğ‘–
), along with the residuals of the Dirichlet boundary conditions of the velocity (ğ‘ŸvelocityBC
ğ‘–
),
and temperature (ğ‘Ÿtemperatureouter-BC
ğ‘–
) and sparse observations of the velocity (ğ‘Ÿvelocityobs
ğ‘–
), pressure (ğ‘Ÿpressureobs
ğ‘–
), and
A. Kashefi & T. Mukerji: Preprint submitted to Elsevier
Page 6 of 25
