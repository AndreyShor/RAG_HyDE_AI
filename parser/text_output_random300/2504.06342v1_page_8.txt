8
where ğœcool is the cooling timescale computed via
the cooling algorithm (detailed in Â§2.6), and ğœdyn is
the dynamical timescale determined by the min-
imum of the local free-fall time and rotational
timescale:
ğœdyn = min(ğœff, ğœrot),
(16)
where
ğœff â‰¡
âˆšï¸„
3ğœ‹
32ğºğœŒ,
(17)
ğœrot â‰¡
âˆšï¸‚
ğ‘Ÿğœ•Î¦(ğ‘Ÿ)
ğœ•ğ‘Ÿ
,
(18)
with Î¦(ğ‘Ÿ) being the gravitational potential. The
star formation rate is then given by:
Â¤ğ‘€SF = ğœ–SF ğœŒ
ğœSF
.
(19)
The model evolution is primarily driven by stellar
mass loss and SNe Ia rates associated with the initial
stellar distribution. Following (Ciotti & Ostriker
2012), we express the stellar mass loss as a piece-
wise function:
Î”ğ‘€=
ï£±ï£´ï£´ï£²
ï£´ï£´ï£³
0.945ğ‘€TO âˆ’0.503MâŠ™,
if ğ‘€TO < 9MâŠ™
ğ‘€TO âˆ’1.4MâŠ™,
if ğ‘€TO â‰¥9MâŠ™
,
(20)
where the stellar turn-off mass ğ‘€TO follows the
relation:
log ğ‘€TO
MâŠ™
= 0.0558

log
ğ‘¡
1 yr
2
âˆ’1.338 log
ğ‘¡
1 yr+7.764.
(21)
We note that while star formation and evolution
models in the literature exhibit considerable vari-
ation in parameters and criteria, we have deliber-
ately adopted a simplified prescription. This ap-
proach minimizes free parameters and maintains
the idealized nature of the simulation, facilitating
focused investigation of AGN feedback effects in a
controlled environment.
2.5. Supernova feedback physics
In MACER2D, supernova feedback was imple-
mented as thermal energy injection proportional
to the local SN event rate.
Without identifying
individual SN events, the energy injection was spa-
tially smoothed, acting as an extra heating term in
the energy equation of the hydrodynamic simula-
tion. While computationally efficient, this simpli-
fied approach did not accurately capture the effects
of discrete supernova explosions, such as shock
propagation and turbulence generation in the ISM
and CGM driven by individual events. MACER3D
significantly improves upon this by implementing
a more sophisticated model of supernova feedback
with state-of-the-art prescriptions.
First, we model supernovae as discrete events.
Given their independent nature, we use a Pois-
son distribution to determine the probability of SN
events occurring:
ğ‘ƒ(ğ‘SN; ğœ‡SN) =
ğ‘’âˆ’ğœ‡SNğœ‡ğ‘SN
SN
ğ‘SN!
,
(22)
where ğœ‡SN is the expected number of SN events
per unit time in a given region, and ğ‘ƒ(ğ‘SN; ğœ‡SN)
gives the probability of observing ğ‘SN events. The
expectation value ğœ‡SN in a given time step Î”ğ‘¡is
determined by the sum of the volume-integrated
type Ia and type II SNe rates:
ğœ‡SN = (ğ‘…II + ğ‘…Ia) Î”ğ‘¡,
(23)
where ğ‘…II and ğ‘…Ia are the type II and type Ia SN
rates, respectively, which are adopted from Ciotti
& Ostriker (2012):
ğ‘…II =
ğœ–II
ğœIIğ‘€II,ZAMS
âˆ«ğ‘¡
0
Â¤ğ‘€SF(ğ‘¡â€²)ğ‘’âˆ’ğ‘¡âˆ’ğ‘¡â€²
ğœII dğ‘¡â€²,
(24)
where ğœ–II = 0.1234 is the type II SN efficiency, re-
flecting the fraction of stellar mass from 9 â€“ 120 MâŠ™
progenitors undergoing core collapse, ğœII = 2 Ã—
107 yr the characteristic type II SN timescale, and
ğ‘€II,ZAMS = 21.34 MâŠ™the IMF-averaged ZAMS
mass of type II SN progenitors. The type Ia SN
rate is given by:
ğ‘…Ia(ğ‘¡) = ğ‘…0â„2 ğ¿B
ğ¿BâŠ™

ğ‘¡
13.7 Gyr
âˆ’ğ‘ 
yrâˆ’1,
(25)
