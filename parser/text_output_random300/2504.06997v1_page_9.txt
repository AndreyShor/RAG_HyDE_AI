9 
Table 3 Baseline flow, physiological and optical parameters at 785 nm of the four-layer model simulation. 
 
Layer 
Layer thickness 
(mm) 
ğœ‡ğœ‡ğ‘ğ‘ (mm-1) 
ğœ‡ğœ‡ğ‘ ğ‘ 
â€² (mm-1) 
ğ·ğ·ğ‘ğ‘ (mm2/s) 
four-layer slab 
Scalp 
3 
0.019 
0.726 
1 Ã— 10âˆ’6 
Skull 
7 
0.014 
0.946 
8 Ã— 10âˆ’8 
CSF 
2 
0.001 
0.002 
1 Ã— 10âˆ’8 
Brain 
âˆ 
0.020 
1.210 
6 Ã— 10âˆ’6 
We use ğ·ğ·ğ‘ğ‘_ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ and ğ·ğ·ğ‘ğ‘_ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘  to represent the Brownian diffusion coefficients in brain and scalp, 
respectively. We first simulated a pulsatile waveform of ğ·ğ·ğ‘ğ‘_ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ while gradually increasing 
ğ·ğ·ğ‘ğ‘_ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘  to show the model's performance in recovering the ğ·ğ·ğ‘ğ‘_ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ waveform as well as its 
ability to identify the influence of ğ·ğ·ğ‘ğ‘_ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ . For the simulations, ğ·ğ·ğ‘ğ‘_ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ ranges from 3Ã—10-6 
mm2/s to 9Ã—10-6 mm2/s follows a pulsatile pattern, while the ğ·ğ·ğ‘ğ‘_ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘  gradually increases from 
5Ã—10-7 mm2/s to 1.5Ã—10-6 mm2/s. Other parameters remain the same as in the baseline condition, 
and one level of noise (middle) was added to the simulated data as described previously. For 
CBFibaseline recovery, we simulated 100 noise-added data samples under the baseline condition 
(Table 3). The mean values of the recovered CBFi from the DL model and the decorrelation speed 
measured using single-exponential fitting across the 100 data samples were used as the baseline 
for calculating relative cerebral perfusion changes, respectively. rCBFi was calculated as rCBFi =
CBFi/CBFibaseline
7,27. 
To quantify CBFi sensitivity, ğ·ğ·ğ‘ğ‘_ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ was varied by Â±25% and Â±50% relative to the baseline, 
while maintaining ğ·ğ·ğ‘ğ‘ in other layers constant. Similarly, ğ·ğ·ğ‘ğ‘_ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘ ğ‘  was varied by Â±25% and Â±50% 
relative to the baseline while keeping ğ·ğ·ğ‘ğ‘ in other layers constant, allowing us to evaluate the 
modelâ€™s CBFi measurement sensitivity to scalp BFi (SBFi) changes. At each perturbation level, 
100 noise-added datasets were generated. The sensitivity is defined as49: 
ğ‘†ğ‘†=
(CBFi âˆ’CBFi0)
CBFi0
(ğ·ğ·ğ‘ğ‘âˆ’ğ·ğ·ğ‘ğ‘0)
ğ·ğ·ğ‘ğ‘0
,
(10) 
where CBFi and CBFi0 represent the recovered CBFi under perturbed and baseline conditions, 
respectively, ğ·ğ·ğ‘ğ‘ and ğ·ğ·ğ‘ğ‘0 denote the simulated brain or scalp Brownian coefficient at perturbation 
and baseline conditions. For the fitting method, the numerator of Eq. (10) is replaced by the change 
in decorrelation speed. Ideally, a measured CBFi sensitivity close to 100% is preferred, as it 
indicates accurate detection of cerebral blood flow changes. Conversely, a measured CBFi 
sensitivity to SBFi changes close to 0% suggests that the model is robust against SBFi variations, 
minimizing confounding effects from extracerebral blood flow. 
We also calculated the recovered rCBF error by DL and fitting, calculated using below equation: 
ğœ–ğœ–= (rCBF âˆ’ğ‘Ÿğ‘Ÿğ·ğ·ğ‘ğ‘) Ã— 100%,
(11) 
where rCBF represents the percentage error in recovered relative flow change. 
 
 
