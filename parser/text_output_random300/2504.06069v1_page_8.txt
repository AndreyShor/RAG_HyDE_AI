include an explicit energy conservation term in loss function that penalizes model if its predictions 
violate the physical principle.  
Loss Function Formulation 
Our loss function incorporates multiple physics-informed components, each addressing specific 
electromagnetic aspects of metasurface:  
I. Amplitude loss 
ğ¿ğ‘ğ‘šğ‘= 1
ğ‘âˆ‘(ğ´ğ‘,ğ‘–âˆ’ğ´ğ‘¡,ğ‘–)2
ğ‘
ğ‘–=1
 
(2) 
where ğ´ğ‘,ğ‘– and ğ´ğ‘¡,ğ‘– are the predicted and true amplitude values for sample i respectively, and N is the 
dataset size. 
II. Energy conservation loss 
We use an energy conservation constraint: 
ğ¿ğ‘’ğ‘›ğ‘’ğ‘Ÿğ‘”ğ‘¦= 1
ğ‘âˆ‘(maxâ¡(0â¡, ğ´ğ‘,ğ‘–âˆ’1))2
ğ‘
ğ‘–=1
 
(3) 
This term penalizes only predictions surpassing the physical limit of perfect transmission (ğ´ğ‘,ğ‘–= 1), 
ensuring compliance with the energy conservation principle. 
III. Phase loss 
The phase loss can leverage our sine-cosine representation to calculate error based on measuring of 
the Euclidean distance between true and predicted phases on the unit circle in sine/cosine space: 
ğ¿ğ‘â„ğ‘ğ‘ ğ‘’= 1
ğ‘âˆ‘âˆš(ğ‘ ğ‘–ğ‘›ğ‘›ğ‘œğ‘Ÿğ‘š,ğ‘–âˆ’ğ‘ ğ‘–ğ‘›ğ‘¡,ğ‘–)2â¡+â¡(ğ‘ğ‘œğ‘ ğ‘›ğ‘œğ‘Ÿğ‘š,ğ‘–âˆ’ğ‘ğ‘œğ‘ ğ‘¡,ğ‘–)2
ğ‘
ğ‘–=1
 
(4) 
This formulation provides a physically meaningful calculation of phase error that inherently addresses 
the phase wrapping problem with no discontinuities at the boundaries. Since cosine and sine terms 
represent coordinates on the unit circle, the Euclidean distance captures the chord length between 
true and predicted phase positions. This dimensionless metric ranges from 0 (perfect prediction, 
where true and predicted phase values coincide) to 2 (maximum error, where true and predicted 
phase values are diametrically opposite on the unit circle). The method naturally handles phase 
wrapping at 0/2Ï€ boundaries, as points near these boundaries remain close in sine-cosine space even 
when they appear distant in conventional phase representation. 
