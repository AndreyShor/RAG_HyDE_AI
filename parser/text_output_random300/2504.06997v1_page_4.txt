4 
where ğ›¼ğ›¼ğ‘—ğ‘—
2 = àµ«ğ·ğ·ğ‘—ğ‘—ğ‘ ğ‘ 2 + ğœ‡ğœ‡ğ‘ğ‘,ğ‘—ğ‘—+ 2ğ‘£ğ‘£ğœ‡ğœ‡ğ‘ ğ‘ ,ğ‘—ğ‘—
â€² ğ‘˜ğ‘˜0
2ğ·ğ·ğ‘ğ‘,ğ‘—ğ‘—àµ¯/ğ·ğ·ğ‘—ğ‘—, ğ‘£ğ‘£ is the light speed, ğ‘§ğ‘§ğ‘ğ‘= 2ğ·ğ·1(1 + Reff)/(1 âˆ’
Reff). The Fourier inversion of Eq. (3) is 
ğºğº1
1(ğœŒğœŒ, ğ‘§ğ‘§, ğœğœ) = 1
2ğœ‹ğœ‹à¶±ğºğºà·¨1,1(ğ‘ ğ‘ , ğ‘§ğ‘§, ğœğœ)ğ‘ ğ‘ ğ½ğ½0(ğ‘ ğ‘ ğ‘ ğ‘ )dğ‘ ğ‘ 
âˆ
0
,
(4) 
where ğ½ğ½0 is the zeroth order Bessel function of the first kind10,36. 
The normalized electric field temporal ACF, ğ‘”ğ‘”1(ğœğœ), is related to the normalized light intensity 
ACF, ğ‘”ğ‘”2(ğœğœ), through the Siegert equation37: 
ğ‘”ğ‘”2(ğœğœ) = 1 + ğ›½ğ›½|ğ‘”ğ‘”1(ğœğœ)|2,
(5) 
where ğ›½ğ›½ depends on the laser stability, coherence length, and the number of speckles detected34. 
The experimentally measured light intensity ACF can be calculated as: 
ğ‘”ğ‘”2(ğœğœ) = âŒ©ğ¼ğ¼(ğ‘¡ğ‘¡)ğ¼ğ¼(ğ‘¡ğ‘¡+ ğœğœ)âŒª
âŒ©ğ¼ğ¼(ğ‘¡ğ‘¡)âŒª2
,
(6) 
where âŒ©â€¦ âŒª denotes the average over the integration time ğ‘‡ğ‘‡ğ‘–ğ‘–ğ‘–ğ‘–ğ‘–ğ‘–, and ğ¼ğ¼(ğ‘¡ğ‘¡) is the measured light 
intensity fluctuation. By fitting the measured light intensity ACF to the analytical solution, the BFi 
(ğ›¼ğ›¼ğ·ğ·ğ‘ğ‘) can be extracted. 
2.2 Training dataset preparation 
The clean training dataset was generated using the two-layer DCS analytical model. Based on 
previous studies10,38, we varied only the dominant parameters of the model. Specifically, we varied 
the brain ğœ‡ğœ‡ğ‘ğ‘ and ğœ‡ğœ‡ğ‘ ğ‘ 
â€², the extracerebral layer thickness, and the extracerebral layer ğ·ğ·ğ‘ğ‘ (ğ·ğ·ğ‘ğ‘_ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’) and 
brain ğ·ğ·ğ‘ğ‘ (ğ·ğ·ğ‘ğ‘_ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘), while keeping other parameters constant. The brain ğœ‡ğœ‡ğ‘ğ‘ varied linearly from 
0.005 to 0.025 mm-1 with a step size of 0.005 mm-1, and the brain ğœ‡ğœ‡ğ‘ ğ‘ 
â€² varied from 0.9 to 1.3 mm-1 
(the step size: 0.1 mm-1). The extracerebral layer thickness varied from 8 to 15 mm (the step size: 
1 mm). ğ·ğ·ğ‘ğ‘_ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ varied linearly from 5Ã—10-7 to 5Ã—10-5 mm2/s with a step of 5Ã—10-7 mm2/s (100 
steps). Each ğ·ğ·ğ‘ğ‘_ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ corresponded to 20 steps of ğ·ğ·ğ‘ğ‘_ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ , with the extracerebral-to-brain ğ·ğ·ğ‘ğ‘ 
fraction ranging from 0.05 to 0.3. This relationship was estimated from previous reports39,40. In 
total, we simulated 400,000 clean ğ‘”ğ‘”2 data (5Ã—5Ã—8Ã—100Ã—20). The ğ·ğ·ğ‘ğ‘, physiological and optical 
properties for the two-layer analytical model were adopted from previous studies10,14,38,39,41â€“43, to 
ensure a thorough coverage of relevant ranges. ğœŒğœŒ was fixed at 35 mm, ğ›½ğ›½ was assumed to be 0.5, 
and the lag time ğœğœ ranged from 1.28 to 39.68 Âµs (step size: 1.28 Âµs) to align with the hardware 
settings (see Sec. 2.3). We fixed ğ›½ğ›½ as a constant because scaling the ğ‘”ğ‘”2 curve to the same range 
will eliminate the influence of ğ›½ğ›½ variance at a given flow rate. As a result, it is unnecessary to vary 
ğ›½ğ›½ to account for potential hardware instability (see Sec. 2.3 for details). The parameter 
configurations are summarized in Table 1. 
Table 1 Simulation parameters for the two-layer analytical model. 
Tissue type 
ğğğ’‚ğ’‚ (mm-1) 
ğğğ’”ğ’”
â€² (mm-1) 
Tissue thickness 
(mm) 
ğ‘«ğ‘«ğ’ƒğ’ƒ (mm2/s) 
Extracerebral layer 
0.019 
0.86 
(8, 15) 
(0.05, 0.3) Ã— ğ·ğ·ğ‘ğ‘_ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ 
Brain 
(0.005, 0.025) 
(0.9, 1.3) 
âˆ 
(5Ã—10-7, 5Ã—10-5) 
 
